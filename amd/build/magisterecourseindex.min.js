define(["jquery","core/log","core/config"],function(a,b,c){var d={init:function(){a(".courseindex-coursethumb.direct").bind("click",this.goto_course),a(".courseindex-coursename.direct").bind("click",this.goto_course),a(".courseindex-coursethumb.detailed").bind("click",this.load_course_detail),a(".courseindex-coursename.detailed").bind("click",this.load_course_detail),a(".courseindex-readmorelink").bind("click",this.load_course_detail),a(".modal-close").bind("click",this.close_course_detail),a(".ftoggle-handle").bind("click",this.toggle),a("#courseindex-modal-shadow").bind("click",this.close_course_detail),d.opencurrenttree(),b.debug("AMD local_courseindex magistere module init.")},search_form_submit:function(){var a=document.forms.statusform.lpstatus;if(a){var b=a.selectedIndex;b&&(document.forms.classifierform.lpstatus.value=a.options[b].value)}},textsearch_form_submit:function(){var a=document.forms.textsearchform.lpstatus;if(a){var b=a.selectedIndex;b&&(document.forms.textsearchform.lpstatus.value=a.options[b].value)}},special_form_submit:function(){var a=document.forms.statusform.lpstatus;if(a){var b=a.selectedIndex;b&&(document.forms.specialform.lpstatus.value=a.options[b].value)}},load_course_detail:function(){var b=a(this),d='<div class="centered"><center><img id="detail-waiter" src="';d+=c.wwwroot+'/pix/i/ajaxloader.gif" /></center></div>',a("#courseindex-course-detail-content").html(d),a("#courseindex-course-detail-actions").html(d);var e=b.closest(".local-courseindex-fp-coursebox");if("page"===e.attr("data-format")){var f=c.wwwroot+"/course/format/page/viewpage.php";f+="?id="+e.attr("data-course"),f+="&page="+e.attr("data-page"),a.get(f,function(b){a("#courseindex-course-detail-content").html(b)},"html")}else{var f=c.wwwroot+"/local/courseindex/pro/ajax/viewcourse.php";f+="?id="+e.attr("data-course"),a.get(f,function(b){a("#courseindex-course-detail-content").html(b)},"html")}var f=c.wwwroot+"/local/courseindex/pro/ajax/courseactions.php";f+="?id="+e.attr("data-course"),a.get(f,function(b){a("#courseindex-course-detail-actions").html(b)},"html"),a("body").addClass("courseindex-detail-open"),a("#courseindex-modal-shadow").css("display","block")},close_course_detail:function(){a("body").removeClass("courseindex-detail-open"),a("#courseindex-modal-shadow").css("display","none")},goto_course:function(){var b=a(this),d=b.closest(".local-courseindex-fp-coursebox"),e=c.wwwroot+"/course/view.php";e+="?id="+d.attr("data-course"),window.location=e},toggle:function(){var b=a(this),c=b.attr("data-toggle"),d=c.replace("toggle-","");if("none"===a("#"+c).css("display")){a("#"+c).css("display","block");var e=a("#ftoggle-handle-"+d+" img").attr("src");e&&e.replace("collapsed","expanded"),a("#ftoggle-handle-"+d+" img").attr("src",e),a("#ftoggle-handle-"+d+" i").hasClass("fa-caret-down")?(a("#ftoggle-handle-"+d+" i").removeClass("fa-caret-down"),a("#ftoggle-handle-"+d+" i").addClass("fa-caret-up")):(a("#ftoggle-handle-"+d+" i").removeClass("fa-plus-square"),a("#ftoggle-handle-"+d+" i").addClass("fa-minus-square"))}else{a("#"+c).css("display","none");var e=a("#ftoggle-handle-"+d+" img").attr("src");e&&e.replace("expanded","collapsed"),a("#ftoggle-handle-"+d+" img").attr("src",e),a("#ftoggle-handle-"+d+" i").hasClass("fa-caret-up")?(a("#ftoggle-handle-"+d+" i").removeClass("fa-caret-up"),a("#ftoggle-handle-"+d+" i").addClass("fa-caret-down")):(a("#ftoggle-handle-"+d+" i").removeClass("fa-minus-square"),a("#ftoggle-handle-"+d+" i").addClass("fa-plus-square"))}},opencurrenttree:function(){var b,c,d,e=a(".is-current"),f=e.parents(".subcats");f.each(function(){d=a(this),b=d.attr("id"),c=b.replace("toggle-",""),d.css("display","block");var e=a("#ftoggle-handle-"+c+" img").attr("src");e&&e.replace("collapsed","expanded"),a("#ftoggle-handle-"+c+" i").hasClass("fa-caret-down")?(a("#ftoggle-handle-"+c+" i").removeClass("fa-caret-down"),a("#ftoggle-handle-"+c+" i").addClass("fa-caret-up")):(a("#ftoggle-handle-"+c+" i").removeClass("fa-plus-square"),a("#ftoggle-handle-"+c+" i").addClass("fa-minus-square")),a("#ftoggle-handle-"+c+" img").attr("src",e)})}};return d});