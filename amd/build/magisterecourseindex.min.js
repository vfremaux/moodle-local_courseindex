/**
 * Javascript controller for controlling the sections.
 *
 * @module     local_courseindex/magisterecourseindex
 * @package    local_courseindex
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_courseindex/magisterecourseindex",["jquery","core/log","core/config"],(function($,log,cfg){var magisterecourseindex={init:function(args){$(".courseindex-coursethumb.direct").bind("click",this.goto_course),$(".courseindex-coursename.direct").bind("click",this.goto_course),$(".courseindex-coursethumb.detailed").bind("click",this.load_course_detail),$(".courseindex-coursename.detailed").bind("click",this.load_course_detail),$(".courseindex-readmorelink").bind("click",this.load_course_detail),$(".modal-close").bind("click",this.close_course_detail),$(".courseindex-filter-value").bind("change",this.submitfilters),$(".ftoggle-handle").bind("click",this.toggle),$("#courseindex-modal-shadow").bind("click",this.close_course_detail),$("#search-input").bind("keypress",this.search_form_submit),$("#courseindex-nav").length&&magisterecourseindex.opencurrenttree(),args=args.replace(/,/g,"-"),$("#ftoggle-handle"+args).trigger("click"),log.debug("AMD local_courseindex magistere module init.")},submitfilters:function(){$("#courseindex-magistere-filter-form").submit()},search_form_submit:function(ev){if("13"==(ev.keyCode?ev.keyCode:ev.which)){var url=cfg.wwwroot+"/local/courseindex/explorer.php";url+="?lpstatus=",url+="&searchtext="+$("#search-input").val(),url+="&title=1&description=1&go_freesearch=Chercher",window.location=url}},load_course_detail:function(){var that=$(this),waiter='<div class="centered"><center><img id="detail-waiter" src="';waiter+=cfg.wwwroot+'/pix/i/ajaxloader.gif" /></center></div>',$("#courseindex-course-detail-content").html(waiter),$("#courseindex-course-detail-actions").html(waiter);var coursebox=that.closest(".local-courseindex-fp-coursebox");if("page"===coursebox.attr("data-format")){var url=cfg.wwwroot+"/course/format/page/viewpage.php";url+="?id="+coursebox.attr("data-course"),url+="&page="+coursebox.attr("data-page"),$.get(url,(function(data){$("#courseindex-course-detail-content").html(data)}),"html")}else{url=cfg.wwwroot+"/local/courseindex/pro/ajax/viewcourse.php";url+="?id="+coursebox.attr("data-course"),$.get(url,(function(data){$("#courseindex-course-detail-content").html(data)}),"html")}url=cfg.wwwroot+"/local/courseindex/pro/ajax/courseactions.php";url+="?id="+coursebox.attr("data-course"),$.get(url,(function(data){$("#courseindex-course-detail-actions").html(data)}),"html"),$("body").addClass("courseindex-detail-open"),$("#courseindex-modal-shadow").css("display","block")},close_course_detail:function(){$("body").removeClass("courseindex-detail-open"),$("#courseindex-modal-shadow").css("display","none")},goto_course:function(){var coursebox=$(this).closest(".local-courseindex-fp-coursebox"),url=cfg.wwwroot+"/course/view.php";url+="?id="+coursebox.attr("data-course"),window.location=url},toggle:function(){var src,target=$(this).attr("data-toggle"),toggleid=target.replace("toggle-","");"none"===$("#"+target).css("display")?($("#"+target).css("display","block"),(src=$("#ftoggle-handle-"+toggleid+" img").attr("src"))&&src.replace("collapsed","expanded"),$("#ftoggle-handle-"+toggleid+" img").attr("src",src),$("#ftoggle-handle-"+toggleid+" i").hasClass("fa-caret-down")?($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-caret-down"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-caret-up")):($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-plus-square"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-minus-square"))):($("#"+target).css("display","none"),(src=$("#ftoggle-handle-"+toggleid+" img").attr("src"))&&src.replace("expanded","collapsed"),$("#ftoggle-handle-"+toggleid+" img").attr("src",src),$("#ftoggle-handle-"+toggleid+" i").hasClass("fa-caret-up")?($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-caret-up"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-caret-down")):($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-minus-square"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-plus-square")))},opencurrenttree:function(){var target,toggleid,that;$(".is-current").parents(".subcats").each((function(){that=$(this),target=that.attr("id"),toggleid=target.replace("toggle-",""),that.css("display","block");var src=$("#ftoggle-handle-"+toggleid+" img").attr("src");src&&src.replace("collapsed","expanded"),$("#ftoggle-handle-"+toggleid+" i").hasClass("fa-caret-down")?($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-caret-down"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-caret-up")):($("#ftoggle-handle-"+toggleid+" i").removeClass("fa-plus-square"),$("#ftoggle-handle-"+toggleid+" i").addClass("fa-minus-square")),$("#ftoggle-handle-"+toggleid+" img").attr("src",src)}))}};return magisterecourseindex}));

//# sourceMappingURL=magisterecourseindex.min.js.map